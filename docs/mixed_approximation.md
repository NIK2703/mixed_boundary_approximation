## Метод смешанной аппроксимации  

---

### 1. Целевой функционал

Для нахождения оптимальной аппроксимирующей функции $F(x)$ минимизируется составной функционал:

$$
J = \sum_{i} \frac{\|f(x_i) - F(x_i)\|^2}{\sigma_i} \;+\; \sum_{j} \frac{B_j}{\|f(y_j) - F(y_j)\|^2} \;+\; \gamma \int\limits_{a}^{b} \bigl(F''(x)\bigr)^2 \, dx
$$

где:
- $x \in [a, b]$ — область определения аппроксимируемой функции.

---

### 2. Условия интерполяции

В выделенных узлах $z_e$ аппроксимирующая функция обязана точно проходить через заданные значения:

$$
F(z_e) = f(z_e), \quad e = 1, \dots, m
$$

---

### 3. Форма аппроксимирующей функции

Аппроксимирующая функция ищется в классе алгебраических полиномов степени $n$:

$$
F(x) = a_1 x^n + a_2 x^{n-1} + \dots + a_n x + a_0 = \sum_{k=0}^{n} a_{n+1-k} \, x^{k}
$$

Коэффициенты $a_0, a_1, \dots, a_n$ определяются путём минимизации функционала $J$ при выполнении условий интерполяции.

---

### 4. Обозначения

| Обозначение | Описание |
|-------------|----------|
| $x_i$ | Аппроксимирующие точки (точки «притяжения») |
| $y_j$ | Отталкивающие точки (точки, которых следует избегать) |
| $z_e$ | Узлы точной интерполяции |
| $f(x)$ | Исходная (аппроксимируемая) функция |
| $F(x)$ | Искомая аппроксимирующая функция |
| $\sigma_i > 0$ | Веса аппроксимирующих точек ($\sigma_i$ обратно пропорциональны дисперсии измерений) |
| $B_j > 0$ | Веса отталкивающих точек |
| $\gamma \geq 0$ | Коэффициент регуляризации (сглаживания) |
| $[a, b]$ | Интервал определения функции |

---

### 5. Составляющие функционала

Метод объединяет три компонента:

| Компонент | Математическая форма | Назначение |
|-----------|----------------------|------------|
| **Аппроксимирующий критерий** | $\displaystyle \sum_{i} \frac{\|f(x_i) - F(x_i)\|^2}{\sigma_i}$ | Обеспечивает близость $F(x)$ к данным в точках $x_i$ с учётом их надёжности (весов $\sigma_i$) |
| **Отталкивающий критерий** | $\displaystyle \sum_{j} \frac{B_j}{\|f(y_j) - F(y_j)\|^2}$ | Формирует «барьер» вокруг точек $y_j$, заставляя $F(x)$ избегать этих областей |
| **Регуляризация (сглаживание)** | $\displaystyle \gamma \int\limits_{a}^{b} \bigl(F''(x)\bigr)^2 dx$ | Обеспечивает гладкость решения и устойчивость к шуму (борьба с переобучением) |

---

### 6. Замечания по реализации

1. **Корректность отталкивающего члена**: При приближении $F(y_j) \to f(y_j)$ знаменатель стремится к нулю, что приводит к росту функционала. Это создаёт эффективный «барьер», предотвращающий прохождение аппроксиманта через запрещённые области.

2. **Выбор параметров**:
   - $\sigma_i$ обычно выбираются обратно пропорционально дисперсии измерений в точке $x_i$.
   - $B_j$ определяют «силу» отталкивания; большие значения усиливают избегание точек $y_j$.
   - $\gamma$ контролирует компромисс между точностью аппроксимации и гладкостью; $\gamma = 0$ даёт нерегуляризованное решение.

3. **Численная реализация**: Задача сводится к решению системы нелинейных уравнений (условия стационарности функционала с учётом ограничений интерполяции), которая решается итерационными методами (градиентный спуск, метод Ньютона и др.).
