#include "mixed_approximation/gauss_quadrature.h"

namespace mixed_approx {

// Вспомогательные функции для квадратуры Гаусса-Лежандра
namespace {
    
const std::vector<double> GAUSS_LEGENDRE_NODES_10 = {
    -0.9739065285171717, -0.8650633666889845, -0.6794095682990244,
    -0.4333953941292472, -0.14887433898163122, 0.14887433898163122,
    0.4333953941292472, 0.6794095682990244, 0.8650633666889845,
    0.9739065285171717
};

const std::vector<double> GAUSS_LEGENDRE_WEIGHTS_10 = {
    0.06667134430868814, 0.1494513491505806, 0.21908636251598204,
    0.26926671930999635, 0.29552422471475287, 0.29552422471475287,
    0.26926671930999635, 0.21908636251598204, 0.1494513491505806,
    0.06667134430868814
};

const std::vector<double> GAUSS_LEGENDRE_NODES_20 = {
    -0.9931285991850949, -0.9639719272779138, -0.9122344282513259,
    -0.8391169718222188, -0.7463319064601508, -0.636053680726515,
    -0.5108670019508271, -0.37370608871541955, -0.22778585114164507,
    -0.07652652113349733, 0.07652652113349733, 0.22778585114164507,
    0.37370608871541955, 0.5108670019508271, 0.636053680726515,
    0.7463319064601508, 0.8391169718222188, 0.9122344282513259,
    0.9639719272779138, 0.9931285991850949
};

const std::vector<double> GAUSS_LEGENDRE_WEIGHTS_20 = {
    0.017614007139152118, 0.04060142980038694, 0.06267204833410906,
    0.08327674157670475, 0.10193011981724044, 0.11819453196151842,
    0.13168863844917664, 0.14209610931838205, 0.14917298647260374,
    0.15275338713072585, 0.15275338713072585, 0.14917298647260374,
    0.14209610931838205, 0.13168863844917664, 0.11819453196151842,
    0.10193011981724044, 0.08327674157670475, 0.06267204833410906,
    0.04060142980038694, 0.017614007139152118
};

} // anonymous namespace

void get_gauss_legendre_quadrature(int n, std::vector<double>& nodes, std::vector<double>& weights) {
    if (n <= 10) {
        nodes = GAUSS_LEGENDRE_NODES_10;
        weights = GAUSS_LEGENDRE_WEIGHTS_10;
        if (n < 10) {
            nodes.resize(n);
            weights.resize(n);
        }
    } else if (n <= 20) {
        nodes = GAUSS_LEGENDRE_NODES_20;
        weights = GAUSS_LEGENDRE_WEIGHTS_20;
        if (n < 20) {
            nodes.resize(n);
            weights.resize(n);
        }
    } else {
        nodes = GAUSS_LEGENDRE_NODES_20;
        weights = GAUSS_LEGENDRE_WEIGHTS_20;
    }
}

double transform_to_standard_interval(double t, double a, double b) {
    return 0.5 * (b - a) * t + 0.5 * (a + b);
}

} // namespace mixed_approx
